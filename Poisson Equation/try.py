import math
from scipy.io import loadmat
from sys import path
path.insert(0, 'General/')
import Neighbors
import normals
import matplotlib.pyplot as plt
import numpy as np

nube = 'CAB_1'
mat = loadmat('Regions/Clouds/' + nube + '.mat')

p   = mat['p']
pb  = mat['pb']
vec = mat['vec']
tt  = mat['t']
nvec = 9

p  = np.array([[ 0.5       ,  0.        ],
       [ 0.53206062,  0.06588338],
       [ 0.55023327,  0.13838922],
       [ 0.54970761,  0.21295786],
       [ 0.52823149,  0.28365432],
       [ 0.48660237,  0.34445868],
       [ 0.42847864,  0.39060989],
       [ 0.35955979,  0.41967998],
       [ 0.28633217,  0.4321186 ],
       [ 0.21467876,  0.43113306],
       [ 0.14868117,  0.42192653],
       [ 0.08989431,  0.41046998],
       [ 0.03725957,  0.40209482],
       [-0.01233116,  0.40023667],
       [-0.06296477,  0.40562579],
       [-0.11839494,  0.41611505],
       [-0.18081225,  0.42718581],
       [-0.25      ,  0.4330127 ],
       [-0.32308699,  0.42783632],
       [-0.39496521,  0.40732138],
       [-0.45928072,  0.36958182],
       [-0.50976759,  0.31563473],
       [-0.54161116,  0.24918067],
       [-0.55251741,  0.17576844],
       [-0.54323342,  0.10154792],
       [-0.51739176,  0.03191163],
       [-0.48071156, -0.02964927],
       [-0.43973968, -0.08220159],
       [-0.40042459, -0.12738423],
       [-0.36685412, -0.16877967],
       [-0.34044954, -0.21079743],
       [-0.31979985, -0.25734199],
       [-0.30116873, -0.31059055],
       [-0.27954764, -0.37018091],
       [-0.25      , -0.4330127 ],
       [-0.20897363, -0.4937197 ],
       [-0.15526805, -0.5457106 ],
       [-0.09042689, -0.58253968],
       [-0.0184639 , -0.59928905],
       [ 0.05500879, -0.59363935],
       [ 0.12403877, -0.56637834],
       [ 0.18367363, -0.5212279 ],
       [ 0.2310596 , -0.46403023],
       [ 0.26603281, -0.40148379],
       [ 0.29105851, -0.33972494],
       [ 0.31053027, -0.28308575],
       [ 0.32959454, -0.23331515],
       [ 0.3527807 , -0.18943924],
       [ 0.38276462, -0.14828381],
       [ 0.41956367, -0.1055245 ],
       [ 0.46035989, -0.05700491],
       [ 0.51603031,  0.03294169],
       [ 0.54114694,  0.1021363 ],
       [ 0.54997044,  0.17567354],
       [ 0.53896955,  0.24830609],
       [ 0.50741693,  0.3140565 ],
       [ 0.45754051,  0.36753429],
       [ 0.39401922,  0.40514494],
       [ 0.32294598,  0.42589929],
       [ 0.25050546,  0.43162583],
       [ 0.18167997,  0.4265298 ],
       [ 0.11928774,  0.41619826],
       [ 0.06357694,  0.4062824 ],
       [ 0.01246421,  0.40116574],
       [-0.03764796,  0.40293123],
       [-0.09067985,  0.41087042],
       [-0.14960359,  0.42165043],
       [-0.21540612,  0.43009926],
       [-0.2865435 ,  0.43042451],
       [-0.3590261 ,  0.41757885],
       [-0.42712297,  0.3884516 ],
       [-0.48452416,  0.34260828],
       [-0.52568937,  0.2824077 ],
       [-0.54706428,  0.21247456],
       [-0.54787541,  0.13865818],
       [-0.53031259,  0.06672978],
       [-0.49905166,  0.00113118],
       [-0.46022562, -0.05592543],
       [-0.42008214, -0.10479291],
       [-0.38363935, -0.14808195],
       [-0.35365183, -0.18978855],
       [-0.3301247 , -0.23406971],
       [-0.31048429, -0.28396627],
       [-0.29035819, -0.34038573],
       [-0.26477382, -0.4015968 ],
       [-0.22948681, -0.4633662 ],
       [-0.18212084, -0.51971515],
       [-0.12284747, -0.56412514],
       [-0.05444539, -0.59091437],
       [ 0.01827244, -0.5964642 ],
       [ 0.08952378, -0.58000885],
       [ 0.1538562 , -0.54380312],
       [ 0.20736661, -0.49262906],
       [ 0.2485462 , -0.43275701],
       [ 0.27854566, -0.37060436],
       [ 0.30079439, -0.31140534],
       [ 0.32006241, -0.25820045],
       [ 0.34118762, -0.21137719],
       [ 0.36777266, -0.16886152],
       [ 0.40116415, -0.12690415],
       [ 0.43996178, -0.0812647 ],
       [ 0.48017995, -0.02850245],
       [0,0]])
pb = np.array([[ 0.5       ,  0.        ],
       [ 0.53206062,  0.06588338],
       [ 0.55023327,  0.13838922],
       [ 0.54970761,  0.21295786],
       [ 0.52823149,  0.28365432],
       [ 0.48660237,  0.34445868],
       [ 0.42847864,  0.39060989],
       [ 0.35955979,  0.41967998],
       [ 0.28633217,  0.4321186 ],
       [ 0.21467876,  0.43113306],
       [ 0.14868117,  0.42192653],
       [ 0.08989431,  0.41046998],
       [ 0.03725957,  0.40209482],
       [-0.01233116,  0.40023667],
       [-0.06296477,  0.40562579],
       [-0.11839494,  0.41611505],
       [-0.18081225,  0.42718581],
       [-0.25      ,  0.4330127 ],
       [-0.32308699,  0.42783632],
       [-0.39496521,  0.40732138],
       [-0.45928072,  0.36958182],
       [-0.50976759,  0.31563473],
       [-0.54161116,  0.24918067],
       [-0.55251741,  0.17576844],
       [-0.54323342,  0.10154792],
       [-0.51739176,  0.03191163],
       [-0.48071156, -0.02964927],
       [-0.43973968, -0.08220159],
       [-0.40042459, -0.12738423],
       [-0.36685412, -0.16877967],
       [-0.34044954, -0.21079743],
       [-0.31979985, -0.25734199],
       [-0.30116873, -0.31059055],
       [-0.27954764, -0.37018091],
       [-0.25      , -0.4330127 ],
       [-0.20897363, -0.4937197 ],
       [-0.15526805, -0.5457106 ],
       [-0.09042689, -0.58253968],
       [-0.0184639 , -0.59928905],
       [ 0.05500879, -0.59363935],
       [ 0.12403877, -0.56637834],
       [ 0.18367363, -0.5212279 ],
       [ 0.2310596 , -0.46403023],
       [ 0.26603281, -0.40148379],
       [ 0.29105851, -0.33972494],
       [ 0.31053027, -0.28308575],
       [ 0.32959454, -0.23331515],
       [ 0.3527807 , -0.18943924],
       [ 0.38276462, -0.14828381],
       [ 0.41956367, -0.1055245 ],
       [ 0.46035989, -0.05700491],
       [ 0.51603031,  0.03294169],
       [ 0.54114694,  0.1021363 ],
       [ 0.54997044,  0.17567354],
       [ 0.53896955,  0.24830609],
       [ 0.50741693,  0.3140565 ],
       [ 0.45754051,  0.36753429],
       [ 0.39401922,  0.40514494],
       [ 0.32294598,  0.42589929],
       [ 0.25050546,  0.43162583],
       [ 0.18167997,  0.4265298 ],
       [ 0.11928774,  0.41619826],
       [ 0.06357694,  0.4062824 ],
       [ 0.01246421,  0.40116574],
       [-0.03764796,  0.40293123],
       [-0.09067985,  0.41087042],
       [-0.14960359,  0.42165043],
       [-0.21540612,  0.43009926],
       [-0.2865435 ,  0.43042451],
       [-0.3590261 ,  0.41757885],
       [-0.42712297,  0.3884516 ],
       [-0.48452416,  0.34260828],
       [-0.52568937,  0.2824077 ],
       [-0.54706428,  0.21247456],
       [-0.54787541,  0.13865818],
       [-0.53031259,  0.06672978],
       [-0.49905166,  0.00113118],
       [-0.46022562, -0.05592543],
       [-0.42008214, -0.10479291],
       [-0.38363935, -0.14808195],
       [-0.35365183, -0.18978855],
       [-0.3301247 , -0.23406971],
       [-0.31048429, -0.28396627],
       [-0.29035819, -0.34038573],
       [-0.26477382, -0.4015968 ],
       [-0.22948681, -0.4633662 ],
       [-0.18212084, -0.51971515],
       [-0.12284747, -0.56412514],
       [-0.05444539, -0.59091437],
       [ 0.01827244, -0.5964642 ],
       [ 0.08952378, -0.58000885],
       [ 0.1538562 , -0.54380312],
       [ 0.20736661, -0.49262906],
       [ 0.2485462 , -0.43275701],
       [ 0.27854566, -0.37060436],
       [ 0.30079439, -0.31140534],
       [ 0.32006241, -0.25820045],
       [ 0.34118762, -0.21137719],
       [ 0.36777266, -0.16886152],
       [ 0.40116415, -0.12690415],
       [ 0.43996178, -0.0812647 ],
       [ 0.48017995, -0.02850245]])

#vec = Neighbors.Clouds(p, pb, nvec)
vecs = normals.normals(pb, p)
print('Done')

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(8, 4))

ax1.set_title('Cloud')
ax1.scatter(p[:,0], p[:,1])

ax2.set_title('Vectors')
for i in np.arange(len(pb[:,0])):
    x = [pb[i,0], vecs[i,0]]
    y = [pb[i,1], vecs[i,1]]
    ax2.plot(x, y, 'k')

plt.axis('equal')
plt.show()